<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Geo-rebus</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont;
      text-align: center;
      padding: 2rem;
    }
    button {
      font-size: 1.2rem;
      padding: 1rem 2rem;
    }
    .ok { color: green; font-weight: bold; }
    .nei { color: red; }
  </style>
</head>
<body>

  <h1>üìç Geo-rebus</h1>
  <p>Finn stedet ‚Äì n√•r du er n√¶r nok f√•r du neste ledetr√•d.</p>

  <button onclick="sjekkPosisjon()">Sjekk hvor jeg er</button>

  <p id="resultat"></p>

<script>
  // M√ÖL: Maurstien 6, 0880 Oslo
  const riktigLat = 59.960000;   // 59¬∞57‚Ä≤36‚Ä≥ N
  const riktigLon = 10.756944444; // 10¬∞45‚Ä≤25‚Ä≥ √ò
  const tillattAvstand = 40;  // meter

  function sjekkPosisjon() {
    if (!navigator.geolocation) {
      resultat.textContent = "GPS st√∏ttes ikke p√• denne enheten.";
      return;
    }

    navigator.geolocation.getCurrentPosition(
      pos => {
        const d = avstand(
          pos.coords.latitude,
          pos.coords.longitude,
          riktigLat,
          riktigLon
        );

        if (d < tillattAvstand) {
          resultat.innerHTML =
            "<span class='ok'>üéâ Riktig sted! Du er ved Maurstien 6, 0880 Oslo. Neste kode er: 742</span>";
        } else {
          resultat.innerHTML =
            "<span class='nei'>‚ùå Du er " + Math.round(d) + " m unna</span>";
        }
      },
      () => resultat.textContent = "Kunne ikke hente posisjon.",
      { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
    );
  }

  function avstand(lat1, lon1, lat2, lon2) {
    const R = 6371000;
    const toRad = x => x * Math.PI / 180;
    const dLat = toRad(lat2 - lat1);
    const dLon = toRad(lon2 - lon1);

    const a =
      Math.sin(dLat/2)**2 +
      Math.cos(toRad(lat1)) *
      Math.cos(toRad(lat2)) *
      Math.sin(dLon/2)**2;

    return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
  }
</script>

</body>
</html>